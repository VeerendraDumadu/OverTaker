var ObstacleManager=pc.createScript("obstacleManager");ObstacleManager.attributes.add("obstacleParent",{type:"entity",title:"Obstacle Parent"}),ObstacleManager.attributes.add("obstacleGenInterval",{type:"number",default:1,title:"Interval"}),ObstacleManager.attributes.add("lessDenseMinInterval",{type:"number",default:1,title:"Initial Min Interval"}),ObstacleManager.attributes.add("lessDenseMaxInterval",{type:"number",default:1.5,title:"Initial Max Interval"}),ObstacleManager.attributes.add("denseMinInterval",{type:"number",default:.1,title:"End Min Interval"}),ObstacleManager.attributes.add("denseMaxInterval",{type:"number",default:.5,title:"End Max Interval"}),ObstacleManager.attributes.add("obstacleHeightOffset",{type:"number",default:.25,title:"Obstacle Height Offset"}),ObstacleManager.attributes.add("obstacleInitialZPosition",{type:"number",default:-100,title:"Obstacle Initial Z Position"}),ObstacleManager.prototype.initialize=function(){this.app.on("overtakeBike:startTheGame",this.startGameCallback,this),this.app.on("overtakeBike:PauseScreen",this.PauseScreenCallBack,this),this.on("destroy",function(){this.app.off("overtakeBike:startTheGame",this.startGameCallback,this),this.app.off("overtakeBike:PauseScreen",this.PauseScreenCallBack,this)}),this.setupArrayOfElements()},ObstacleManager.prototype.setupArrayOfElements=function(){null!==this.obstacleParent&&this.obstacleParent.children.length>0&&(this.arrOfObstacles=this.obstacleParent.children)},ObstacleManager.prototype.setupAttributes=function(){this.app.fire("overtakeBike:destroyOldItems"),intervalTime=this.getRandomFloat(minIntervalTime,maxIntervalTime),this.maxInterval=this.lessDenseMaxInterval,this.minInterval=this.lessDenseMinInterval,this.decereseSpeed=.01,this.timeSincePrevObsGen=0,this.dense=!1,this.arrIndexCount=0,this.arrOfObstacles.length>0&&(this.arrOfShuffledObj=this.shuffle(this.arrOfObstacles)),this.Pause=!1},ObstacleManager.prototype.update=function(e){gameOver||this.Pause||(this.checkGenerateObtacles(e),this.setRandomIntervalTime(e))},ObstacleManager.prototype.getObstaclesFromPool=function(){if(this.arrOfShuffledObj.length>0){var e=this.arrIndexCount%this.arrOfShuffledObj.length;this.arrIndexCount++;var t=this.arrOfShuffledObj[e];t.enabled=!0,this.xPos=this.getRandomFloat(-8,8),t.setLocalPosition(this.xPos,this.obstacleHeightOffset,this.obstacleInitialZPosition),t.script.has("obstacleHandler")&&t.script.obstacleHandler.startMoving(),this.timeSincePrevObsGen=0}},ObstacleManager.prototype.checkGenerateObtacles=function(e){this.timeSincePrevObsGen>=this.obstacleGenInterval?(this.getObstaclesFromPool(),this.obstacleGenInterval=this.getRandomFloat(this.minInterval,this.maxInterval)):this.timeSincePrevObsGen+=e},ObstacleManager.prototype.setRandomIntervalTime=function(e){intervalTime<maxIntervalTime?intervalTime+=e:(intervalTime=this.getRandomFloat(minIntervalTime,maxIntervalTime),this.dense=!this.dense,this.dense?(this.maxInterval=this.lessDenseMaxInterval,this.minInterval=this.lessDenseMinInterval):(this.maxInterval=this.denseMinInterval,this.minInterval=this.denseMaxInterval))},ObstacleManager.prototype.graduallyIncreaseGenerationSpeed=function(e){this.minInterval>this.denseMinInterval?this.minInterval-=this.decereseSpeed*e:this.minInterval=this.denseMinInterval,this.maxInterval>this.denseMaxInterval?this.maxInterval-=this.decereseSpeed*e:this.maxInterval=this.denseMaxInterval},ObstacleManager.prototype.startGameCallback=function(){this.setupAttributes()},ObstacleManager.prototype.getRandomInt=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},ObstacleManager.prototype.getRandomFloat=function(e,t){return Math.random()*(t-e)+e},ObstacleManager.prototype.shuffle=function(e){for(var t,a,n=e.length;n;)a=Math.floor(Math.random()*n--),t=e[n],e[n]=e[a],e[a]=t;return e};var intervalTime=0,minIntervalTime=6,maxIntervalTime=10;ObstacleManager.prototype.PauseScreenCallBack=function(e){this.Pause=e},this.Pause=!1;var PlayerHandler=pc.createScript("playerHandler");PlayerHandler.attributes.add("laneChangingSpeed",{type:"number",default:1,title:"Lane Changing Speed"}),PlayerHandler.attributes.add("tiltingSpeed",{type:"number",default:1,title:"Tilting Speed"}),PlayerHandler.attributes.add("maxVerticalLimit",{type:"number",default:5,title:"Max Vertical Limit"}),PlayerHandler.attributes.add("uiHandler",{type:"entity",title:"UIHandler"}),PlayerHandler.attributes.add("camera",{type:"entity",title:"Camera"}),PlayerHandler.attributes.add("bikeSound",{type:"entity",title:"BikeSound"}),PlayerHandler.prototype.initialize=function(){this.app.keyboard.on(pc.EVENT_KEYDOWN,this.onKeyDown,this),this.app.keyboard.on(pc.EVENT_KEYUP,this.onKeyUp,this),this.app.on("overtakeBike:startTheGame",this.startGameCallback,this),this.app.on("overtakeBike:leftSidePressed",this.onLeftSideTapCallback,this),this.app.on("overtakeBike:rightSidePressed",this.onRightSideTapCallback,this),this.app.on("overtakeBike:saveGameForLocalLB",this.savePlayerLocalGameDataOnResetCallback,this),this.app.on("overtakeBike:PauseScreen",this.PauseScreenCallBack,this),this.on("destroy",function(){this.app.off("overtakeBike:startTheGame",this.startGameCallback,this),this.app.off("overtakeBike:leftSidePressed",this.onLeftSideTapCallback,this),this.app.off("overtakeBike:rightSidePressed",this.onRightSideTapCallback,this),this.app.off("overtakeBike:saveGameForLocalLB",this.savePlayerLocalGameDataOnResetCallback,this),this.app.off("overtakeBike:PauseScreen",this.PauseScreenCallBack,this)}),this.initialPosition=this.entity.getPosition().clone(),this.initialRotation=this.entity.getRotation().clone(),this.initialEulerAngle=this.entity.getEulerAngles().clone(),null!==this.camera&&(this.cameraInitialPos=this.camera.getPosition().clone())},PlayerHandler.prototype.startGameCallback=function(){this.setupAttributes()},PlayerHandler.prototype.setupAttributes=function(){if(this.goToLeftSide=!1,this.goToRightSide=!1,this.entity.setPosition(this.initialPosition),this.entity.setRotation(this.initialRotation),this.arrOfPlayerLanesXPos=[-3.5,0,3.5],this.laneNumber=1,this.targetPos=this.initialPosition,this.allowLaneChange=!1,this.scoreCount=0,this.highScore=0,null!==this.camera&&this.camera.setPosition(this.cameraInitialPos),localStorage){var t=localStorage.getItem("overtakeBike-high-score");null!==t&&(this.highScore=parseInt(t))}this.maxRotationLimit=new pc.Vec3(4.65,10.05,17.26),gameOver=!1,this.Pause=!1,null!==this.bikeSound&&this.bikeSound.sound.play("BikeSound")},PlayerHandler.prototype.update=function(t){gameOver||this.Pause||(this.smoothLaneChanging(t),this.moveToLeftSide(t),this.moveToRightSide(t))},PlayerHandler.prototype.onLeftSideTapCallback=function(t){t?(this.goToLeftSide=!0,this.goToRightSide=!1):(this.goToLeftSide=!1,this.goToRightSide=!1,this.resetEulerAngleUsingTween())},PlayerHandler.prototype.onRightSideTapCallback=function(t){t?(this.goToLeftSide=!1,this.goToRightSide=!0):(this.goToLeftSide=!1,this.goToRightSide=!1,this.resetEulerAngleUsingTween())},PlayerHandler.prototype.moveToLeftSide=function(t){if(this.goToLeftSide){if(this.tween&&this.tween.stop(),this.entity.getPosition().x>-this.maxVerticalLimit&&this.entity.translate(-this.laneChangingSpeed*t,0,0),null!==this.camera)this.camera.getPosition().x>-this.maxVerticalLimit&&this.camera.translate(-this.laneChangingSpeed*t,0,0);var e=this.entity.getEulerAngles().clone();e.x<this.maxRotationLimit.x&&this.entity.rotate(this.tiltingSpeed*t,0,0),e.y<this.maxRotationLimit.y&&this.entity.rotate(0,this.tiltingSpeed*t,0),e.z<this.maxRotationLimit.z&&this.entity.rotate(0,0,this.tiltingSpeed*t)}},PlayerHandler.prototype.moveToRightSide=function(t){if(this.goToRightSide){if(this.tween&&this.tween.stop(),this.entity.getPosition().x<this.maxVerticalLimit&&this.entity.translate(this.laneChangingSpeed*t,0,0),null!==this.camera)this.camera.getPosition().x<this.maxVerticalLimit&&this.camera.translate(this.laneChangingSpeed*t,0,0);var e=this.entity.getEulerAngles().clone();e.x<this.maxRotationLimit.x&&this.entity.rotate(this.tiltingSpeed*t,0,0),e.y>-this.maxRotationLimit.y&&this.entity.rotate(0,-this.tiltingSpeed*t,0),e.z>-this.maxRotationLimit.z&&this.entity.rotate(0,0,-this.tiltingSpeed*t)}},PlayerHandler.prototype.smoothLaneChanging=function(t){this.app.keyboard.isPressed(pc.KEY_LEFT)?(this.goToLeftSide=!0,this.goToRightSide=!1):this.app.keyboard.isPressed(pc.KEY_RIGHT)&&(this.goToLeftSide=!1,this.goToRightSide=!0),this.app.keyboard.wasReleased(pc.KEY_LEFT)?(this.goToLeftSide=!1,this.goToRightSide=!1,this.resetEulerAngleUsingTween()):this.app.keyboard.wasReleased(pc.KEY_RIGHT)&&(this.goToLeftSide=!1,this.goToRightSide=!1,this.resetEulerAngleUsingTween())},PlayerHandler.prototype.resetEulerAngleUsingTween=function(){this.tween&&this.tween.stop(),this.tween=this.entity.tween(this.entity.getEulerAngles()).rotate({x:0,y:0,z:0},.2,pc.Linear),this.tween.start()},PlayerHandler.prototype.updateScore=function(){null!==this.uiHandler&&(this.scoreCount++,this.scoreCount>this.highScore&&(this.highScore=this.scoreCount,localStorage&&localStorage.setItem("overtakeBike-high-score",this.highScore)),null!==this.uiHandler&&this.uiHandler.script.uiHandler.displayCurrentScore(this.scoreCount),localStorage&&localStorage.setItem("overtakeBike-current-score",this.scoreCount))},PlayerHandler.prototype.savePlayerLocalGameDataOnResetCallback=function(){if(localStorage){var t=[],e=localStorage.getItem("overtakeBike-local-player-data");null!==e&&(e,t=e.split("#").filter(function(t,e,i){return t.length>0}));var i=new Date,a=i.getFullYear(),s=(1+i.getMonth()).toString();1===s.length&&(s="0"+s);var o=i.getDate().toString();1===o.length&&(o="0"+o);var n=i.getHours();n>12&&(n-=12),1===(n=n.toString()).length&&(n="0"+n);var r=i.getMinutes().toString();1===r.length&&(r="0"+r);var l=(this.scoreCount+"*"+n+":"+r+"*"+o+"."+s+"."+a).toString();if(0===t.length?t[t.length]=l:t.length>0&&t.length<10?(t[t.length]=l,t=this.bubbleSortArray(t)):(t.pop(),t[t.length]=l,t=this.bubbleSortArray(t)),t.length>0){for(var h="#",g=0;g<t.length;g++)h+=t[g]+"#";localStorage.setItem("overtakeBike-local-player-data",h)}}},PlayerHandler.prototype.bubbleSortArray=function(t){for(var e=t,i=!0,a=1;a<=e.length-1&&i;a++){i=!1;for(var s=0;s<e.length-1;s++){var o=e[s].split("*"),n=parseInt(o[0],10),r=e[s+1].split("*");if(parseInt(r[0],10)>n){var l=e[s];e[s]=e[s+1],e[s+1]=l,i=!0}}}return e},PlayerHandler.prototype.PauseScreenCallBack=function(t){this.Pause=t,console.log("States :"+this.Pause)};var gameOver=!0;this.Pause=!1;var ObstacleHandler=pc.createScript("obstacleHandler");ObstacleHandler.attributes.add("movingSpeed",{type:"number",default:20,title:"Moving Speed"}),ObstacleHandler.attributes.add("crashSound",{type:"entity",title:"CrashSound"}),ObstacleHandler.attributes.add("bikeSound",{type:"entity",title:"BikeSound"}),ObstacleHandler.attributes.add("position",{type:"number",title:"Randomposition"}),ObstacleHandler.prototype.initialize=function(){this.entity.collision.on("collisionstart",this.onCollisionStart,this),this.app.on("overtakeBike:destroyOldItems",this.returnBackIntoPoolCallback,this),this.app.on("overtakeBike:moveForward",this.moveForwardCallback,this),this.app.on("overtakeBike:PauseScreen",this.PauseScreenCallBack,this),this.on("destroy",function(){this.app.off("overtakeBike:destroyOldItems",this.returnBackIntoPoolCallback,this),this.app.off("overtakeBike:moveForward",this.moveForwardCallback,this),this.app.on("overtakeBike:PauseScreen",this.PauseScreenCallBack,this)}),this.startMovingElement=!1,this.moveForward=!1,this.movingForwardSpeed=30,this.poolPosition=new pc.Vec3(0,200,0),this.currentPosition=this.entity.getLocalPosition(),this.Pause=!1},ObstacleHandler.prototype.update=function(t){this.Pause||(this.move(t),this.checkCurrentPosition())},ObstacleHandler.prototype.startMoving=function(){this.startMovingElement=!0},ObstacleHandler.prototype.move=function(t){this.startMovingElement&&!this.moveForward?this.entity.translateLocal(0,0,this.movingSpeed*t):this.startMovingElement&&this.moveForward&&this.entity.translateLocal(0,0,-this.movingForwardSpeed*t)},ObstacleHandler.prototype.onCollisionStart=function(t){t.other.name.indexOf("Player")>=0&&(this.app.fire("overtakeBike:saveGameForLocalLB"),this.app.fire("overtakeBike:loadGameOver",!0),this.app.fire("overtakeBike:moveForward"),gameOver=!0,null!==this.crashSound&&this.crashSound.sound.play("CrashSound"),null!==this.bikeSound&&this.bikeSound.sound.stop("BikeSound"))},ObstacleHandler.prototype.moveForwardCallback=function(){this.moveForward=!0},ObstacleHandler.prototype.returnBackIntoPoolCallback=function(){this.entity.setLocalPosition(this.poolPosition),this.startMovingElement=!1,this.moveForward=!1,this.entity.enabled=!1},ObstacleHandler.prototype.checkCurrentPosition=function(){(this.currentPosition.z>=15||this.currentPosition.z<=-250)&&this.startMovingElement&&this.returnBackIntoPoolCallback()},ObstacleHandler.prototype.PauseScreenCallBack=function(t){this.Pause=t},this.Pause=!1;var EnvironmentManager=pc.createScript("environmentManager");EnvironmentManager.attributes.add("envItemsParent",{type:"entity",title:"EnvItems Parent"}),EnvironmentManager.attributes.add("envItemGenInterval",{type:"number",default:1,title:"Interval"}),EnvironmentManager.attributes.add("initialMinInterval",{type:"number",default:1,title:"Initial Min Interval"}),EnvironmentManager.attributes.add("initialMaxInterval",{type:"number",default:1.5,title:"Initial Max Interval"}),EnvironmentManager.attributes.add("endMinInterval",{type:"number",default:.1,title:"End Min Interval"}),EnvironmentManager.attributes.add("endMaxInterval",{type:"number",default:.5,title:"End Max Interval"}),EnvironmentManager.attributes.add("envItemMinHeight",{type:"number",default:-3.15,title:"EnvItem Min Height"}),EnvironmentManager.attributes.add("envItemMaxHeight",{type:"number",default:-1.5,title:"EnvItem Max Height"}),EnvironmentManager.attributes.add("envItemInitialZPosition",{type:"number",default:-100,title:"EnvItem Spawn Z Position"}),EnvironmentManager.prototype.initialize=function(){this.app.on("overtakeBike:startTheGame",this.startGameCallback,this),this.app.on("overtakeBike:PauseScreen",this.PauseScreenCallBack,this),this.on("destroy",function(){this.app.off("overtakeBike:startTheGame",this.startGameCallback,this),this.app.off("overtakeBike:PauseScreen",this.PauseScreenCallBack,this)}),this.setupArrayOfElements()},EnvironmentManager.prototype.setupArrayOfElements=function(){null!==this.envItemsParent&&this.envItemsParent.children.length>0&&(this.arrOfEnvItems=this.envItemsParent.children)},EnvironmentManager.prototype.setupAttributes=function(){this.maxInterval=this.initialMaxInterval,this.minInterval=this.initialMinInterval,this.decereseSpeed=.01,this.timeSincePrevObsGen=0,this.arrOfEnvItemXPositions=[-14,14],this.Pause=!1},EnvironmentManager.prototype.update=function(t){gameOver||this.Pause||(this.getEnvItemsFromPool(t),this.graduallyIncreaseGenerationSpeed(t))},EnvironmentManager.prototype.getEnvItemsFromPool=function(t){if(this.arrOfEnvItems.length>0)if(this.timeSincePrevObsGen>this.envItemGenInterval){for(var e=!1,n=0;n=this.getRandomInt(0,this.arrOfEnvItems.length-1),this.arrOfEnvItems[n].enabled||(e=!0),!e;);var a=this.arrOfEnvItems[n];if(a.enabled=!0,this.arrOfEnvItemXPositions.length>0){var i=this.getRandomInt(0,this.arrOfEnvItemXPositions.length-1),r=this.getRandomFloat(this.envItemMinHeight,this.envItemMaxHeight);a.setLocalPosition(this.arrOfEnvItemXPositions[i],r,this.envItemInitialZPosition)}this.envItemGenInterval=this.getRandomFloat(this.minInterval,this.maxInterval),this.timeSincePrevObsGen=0,a.script.has("envHandler")&&a.script.envHandler.startMoving()}else this.timeSincePrevObsGen+=t},EnvironmentManager.prototype.graduallyIncreaseGenerationSpeed=function(t){this.minInterval>this.endMinInterval?this.minInterval-=this.decereseSpeed*t:this.minInterval=this.endMinInterval,this.maxInterval>this.endMaxInterval?this.maxInterval-=this.decereseSpeed*t:this.maxInterval=this.endMaxInterval},EnvironmentManager.prototype.startGameCallback=function(){this.setupAttributes()},EnvironmentManager.prototype.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},EnvironmentManager.prototype.getRandomFloat=function(t,e){return Math.random()*(e-t)+t},EnvironmentManager.prototype.PauseScreenCallBack=function(t){this.Pause=t},this.Pause=!1;var EnvHandler=pc.createScript("envHandler");EnvHandler.attributes.add("movingSpeed",{type:"number",default:20,title:"Moving Speed"}),EnvHandler.prototype.initialize=function(){this.app.on("overtakeBike:destroyOldItems",this.returnBackIntoPoolCallback,this),this.app.on("overtakeBike:PauseScreen",this.PauseScreenCallBack,this),this.on("destroy",function(){this.app.off("overtakeBike:destroyOldItems",this.returnBackIntoPoolCallback,this),this.app.off("overtakeBike:PauseScreen",this.PauseScreenCallBack,this)}),this.startMovingElement=!1,this.poolPosition=new pc.Vec3(0,200,0),this.currentPosition=this.entity.getLocalPosition()},EnvHandler.prototype.update=function(t){this.Pause||(this.move(t),this.checkCurrentPosition())},EnvHandler.prototype.startMoving=function(){this.startMovingElement=!0,this.lerpSpeed=this.movingSpeed,this.slowingRate=5,this.Pause=!1},EnvHandler.prototype.move=function(t){gameOver&&(this.lerpSpeed-=this.slowingRate),this.startMovingElement&&this.lerpSpeed>0&&this.entity.translateLocal(0,0,this.lerpSpeed*t)},EnvHandler.prototype.returnBackIntoPoolCallback=function(){this.entity.setLocalPosition(this.poolPosition),this.startMovingElement=!1,this.entity.enabled=!1},EnvHandler.prototype.checkCurrentPosition=function(){this.currentPosition.z>=15&&this.startMovingElement&&this.returnBackIntoPoolCallback()},EnvHandler.prototype.PauseScreenCallBack=function(t){this.Pause=t},this.Pause=!1;var RoadManager=pc.createScript("roadManager");RoadManager.attributes.add("roadItemsParent",{type:"entity",title:"RoadItems Parent"}),RoadManager.attributes.add("roadItemGenInterval",{type:"number",default:1,title:"Interval"}),RoadManager.attributes.add("initialMinInterval",{type:"number",default:1,title:"Initial Min Interval"}),RoadManager.attributes.add("initialMaxInterval",{type:"number",default:1.5,title:"Initial Max Interval"}),RoadManager.attributes.add("endMinInterval",{type:"number",default:.1,title:"End Min Interval"}),RoadManager.attributes.add("endMaxInterval",{type:"number",default:.5,title:"End Max Interval"}),RoadManager.attributes.add("roadItemInitialZPosition",{type:"number",default:-100,title:"Road Item Spawn Z Position"}),RoadManager.prototype.initialize=function(){this.app.on("overtakeBike:startTheGame",this.startGameCallback,this),this.app.on("overtakeBike:PauseScreen",this.PauseScreenCallBack,this),this.on("destroy",function(){this.app.off("overtakeBike:startTheGame",this.startGameCallback,this),this.app.off("overtakeBike:PauseScreen",this.PauseScreenCallBack,this)}),this.setupArrayOfElements()},RoadManager.prototype.setupArrayOfElements=function(){null!==this.roadItemsParent&&this.roadItemsParent.children.length>0&&(this.arrOfRoadElements=this.roadItemsParent.children)},RoadManager.prototype.setupAttributes=function(){this.maxInterval=this.initialMaxInterval,this.minInterval=this.initialMinInterval,this.decereseSpeed=.01,this.timeSincePrevObsGen=0,this.activeEnvItemsCount=0,this.Pause=!1},RoadManager.prototype.update=function(t){gameOver||this.Pause||(this.getRoadItemsFromPool(t),this.graduallyIncreaseGenerationSpeed(t))},RoadManager.prototype.getRoadItemsFromPool=function(t){if(this.arrOfRoadElements.length>0)if(this.timeSincePrevObsGen>this.roadItemGenInterval){var e=this.activeEnvItemsCount%this.arrOfRoadElements.length,a=this.arrOfRoadElements[e];this.activeEnvItemsCount++,a.enabled=!0,a.setLocalPosition(0,0,this.roadItemInitialZPosition),a.script.has("roadElementHandler")&&a.script.roadElementHandler.startMoving(),this.roadItemGenInterval=this.getRandomFloat(this.minInterval,this.maxInterval),this.timeSincePrevObsGen=0}else this.timeSincePrevObsGen+=t},RoadManager.prototype.graduallyIncreaseGenerationSpeed=function(t){this.minInterval>this.endMinInterval?this.minInterval-=this.decereseSpeed*t:this.minInterval=this.endMinInterval,this.maxInterval>this.endMaxInterval?this.maxInterval-=this.decereseSpeed*t:this.maxInterval=this.endMaxInterval},RoadManager.prototype.startGameCallback=function(){this.setupAttributes()},RoadManager.prototype.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},RoadManager.prototype.getRandomFloat=function(t,e){return Math.random()*(e-t)+t},RoadManager.prototype.PauseScreenCallBack=function(t){this.Pause=t},this.Pause=!1;var RoadElementHandler=pc.createScript("roadElementHandler");RoadElementHandler.attributes.add("movingSpeed",{type:"number",default:20,title:"Moving Speed"}),RoadElementHandler.prototype.initialize=function(){this.app.on("overtakeBike:destroyOldItems",this.returnBackIntoPoolCallback,this),this.app.on("overtakeBike:PauseScreen",this.PauseScreenCallBack,this),this.on("destroy",function(){this.app.off("overtakeBike:destroyOldItems",this.returnBackIntoPoolCallback,this),this.app.off("overtakeBike:PauseScreen",this.PauseScreenCallBack,this)}),this.startMovingElement=!1,this.poolPosition=new pc.Vec3(0,200,0),this.currentPosition=this.entity.getLocalPosition()},RoadElementHandler.prototype.update=function(t){this.Pause||(this.move(t),this.checkCurrentPosition())},RoadElementHandler.prototype.startMoving=function(){this.startMovingElement=!0,this.lerpSpeed=this.movingSpeed,this.slowingRate=5},RoadElementHandler.prototype.move=function(t){gameOver&&(this.lerpSpeed-=this.slowingRate),this.startMovingElement&&this.lerpSpeed>0&&this.entity.translateLocal(0,0,this.lerpSpeed*t)},RoadElementHandler.prototype.returnBackIntoPoolCallback=function(){this.entity.setLocalPosition(this.poolPosition),this.startMovingElement=!1,this.entity.enabled=!1},RoadElementHandler.prototype.checkCurrentPosition=function(){this.currentPosition.z>=15&&this.startMovingElement&&this.returnBackIntoPoolCallback()},RoadElementHandler.prototype.PauseScreenCallBack=function(t){this.Pause=t},this.Pause=!1;var UiHandler=pc.createScript("uiHandler");UiHandler.attributes.add("highScoreText",{type:"entity",title:"High Score"}),UiHandler.attributes.add("currentScoreText",{type:"entity",title:"Current Score"}),UiHandler.attributes.add("currentScoreGameOverText",{type:"entity",title:"Current Score"}),UiHandler.attributes.add("bgSound",{type:"entity",title:"BGSound"}),UiHandler.attributes.add("bgSoundBtn",{type:"entity",title:"BGSound Btn"}),UiHandler.attributes.add("arrOfBGSoundBtnTextures",{type:"asset",assetType:"texture",array:!0,title:"BGSound Btn Textures"}),UiHandler.attributes.add("GameOverScreen",{type:"entity",title:"GameOver Screen"}),UiHandler.attributes.add("PauseScreen",{type:"entity",title:"Pause Screen"}),UiHandler.prototype.initialize=function(){this.uiElements=this.entity.children,this.bgSoundState=!0,this.count=0,this.app.on("overtakeBike:loadMainMenu",this.loadMainMenuCallback,this),this.app.on("overtakeBike:loadGameOver",this.GameOverCallback,this),this.app.on("overtakeBike:PauseScreen",this.PauseScreenCallBack,this),this.app.on("overtakeBike:loadHUD",this.loadHUDCallback,this),this.app.on("overtakeBike:updateBGSoundState",this.updateBGSoundStateCallback,this),this.app.on("overtakeBike:lbWindowState",this.disableAllUiElementsCallback,this),this.on("destroy",function(){this.app.off("overtakeBike:loadMainMenu",this.loadMainMenuCallback,this),this.app.off("overtakeBike:loadHUD",this.loadHUDCallback,this),this.app.off("overtakeBike:PauseScreen",this.PauseScreenCallBack,this),this.app.off("overtakeBike:updateBGSoundState",this.updateBGSoundStateCallback,this),this.app.off("overtakeBike:lbWindowState",this.disableAllUiElementsCallback,this),this.app.on("overtakeBike:loadGameOver",this.GameOverCallback,this)}),this.loadMainMenuCallback()},UiHandler.prototype.loadMainMenuCallback=function(){if(this.mainMenuUiElementsState(!0),this.hudUiElementsState(!1),localStorage){var e=localStorage.getItem("overtakeBike-high-score");if(null!==e){var t=parseInt(e);this.displayHighScore(t)}}},UiHandler.prototype.GameOverCallback=function(e){if(e){if(this.GameOverScreen.enabled=!0,this.hudUiElementsState(!1),localStorage){var t=localStorage.getItem("overtakeBike-high-score");if(null!==t){var i=parseInt(t);this.displayHighScore(i)}}console.log("GameOver")}else this.GameOverScreen.enabled=!1,this.mainMenuUiElementsState(!0)},UiHandler.prototype.PauseScreenCallBack=function(e){this.hudUiElementsState(!e),this.PauseScreen.enabled=e},UiHandler.prototype.loadHUDCallback=function(){this.count++,this.mainMenuUiElementsState(!1),this.hudUiElementsState(!0)},UiHandler.prototype.mainMenuUiElementsState=function(e){if(this.uiElements.length>0)for(var t=0;t<this.uiElements.length;t++)"TitleImage"!==this.uiElements[t].name&&"PlayBtn"!==this.uiElements[t].name&&"HighscoreText"!==this.uiElements[t].name&&"AudioBtn"!==this.uiElements[t].name&&"LbOpenBtn"!==this.uiElements[t].name||(this.uiElements[t].enabled=e),this.count>0&&"BrokenGlassImage"===this.uiElements[t].name&&(this.uiElements[t].enabled=e)},UiHandler.prototype.hudUiElementsState=function(e){if(this.uiElements.length>0)for(var t=0;t<this.uiElements.length;t++)"CurrentScoreText"!==this.uiElements[t].name&&"RightSideBtn"!==this.uiElements[t].name&&"LeftSideBtn"!==this.uiElements[t].name&&"CrossBtn"!==this.uiElements[t].name||(this.uiElements[t].enabled=e);e&&this.displayCurrentScore(0)},this.score=0,UiHandler.prototype.displayCurrentScore=function(e){null!==this.currentScoreText&&(this.score="Score : "+e,this.currentScoreText.element.text=this.score.toString(),this.currentScoreGameOverText.element.text=this.score.toString())},UiHandler.prototype.displayHighScore=function(e){if(null!==this.highScoreText){var t="Best Score : "+e;this.highScoreText.element.text=t.toString()}},UiHandler.prototype.updateBGSoundStateCallback=function(){this.bgSoundState=!this.bgSoundState,null!==this.bgSound&&null!==this.bgSoundBtn&&this.arrOfBGSoundBtnTextures.length>0&&(this.bgSoundState?(this.bgSound.sound.play("BGSound"),this.bgSoundBtn.element.textureAsset=this.arrOfBGSoundBtnTextures[0]):(this.bgSound.sound.stop("BGSound"),this.bgSoundBtn.element.textureAsset=this.arrOfBGSoundBtnTextures[1]))},UiHandler.prototype.disableAllUiElementsCallback=function(e){if(e&&this.uiElements.length>0)for(var t=0;t<this.uiElements.length;t++)this.uiElements[t].enabled=!1};var ButtonHandler=pc.createScript("buttonHandler");ButtonHandler.attributes.add("btnSound",{type:"entity",title:"BtnSound"}),ButtonHandler.attributes.add("UiHandlerObject",{type:"entity",title:"UiHandlerGame Object"}),ButtonHandler.prototype.initialize=function(){this.entity.element.on("mouseenter",this.onEnter,this),this.entity.element.on("mousedown",this.onPress,this),this.entity.element.on("mouseup",this.onRelease,this),this.entity.element.on("mouseleave",this.onLeave,this),this.entity.element.on("touchstart",this.onPress,this),this.entity.element.on("touchend",this.onRelease,this)},ButtonHandler.prototype.onPress=function(t){"PlayBtn"===this.entity.name?(this.startTheGame(),null!==this.btnSound&&this.btnSound.sound.play("BtnSound")):"AudioBtn"===this.entity.name?(this.app.fire("overtakeBike:updateBGSoundState"),null!==this.btnSound&&this.btnSound.sound.play("BtnSound")):"LbOpenBtn"===this.entity.name?(this.app.fire("overtakeBike:lbWindowState",!0),null!==this.btnSound&&this.btnSound.sound.play("BtnSound")):"LbCloseBtn"===this.entity.name?(this.app.fire("overtakeBike:lbWindowState",!1),null!==this.btnSound&&this.btnSound.sound.play("BtnSound")):"LeftSideBtn"===this.entity.name?this.app.fire("overtakeBike:leftSidePressed",!0):"RightSideBtn"===this.entity.name?this.app.fire("overtakeBike:rightSidePressed",!0):"Submit"===this.entity.name?(this.score=this.UiHandlerObject.script.uiHandler.score,console.log("Score"+this.score)):"Restart"===this.entity.name?this.app.fire("overtakeBike:loadGameOver",!1):"CrossBtn"===this.entity.name?this.app.fire("overtakeBike:PauseScreen",!0):"No"===this.entity.name?this.app.fire("overtakeBike:PauseScreen",!1):"Yes"===this.entity.name&&(this.score=this.UiHandlerObject.script.uiHandler.score,console.log("Score"+this.score))},ButtonHandler.prototype.onRelease=function(t){"LeftSideBtn"===this.entity.name?this.app.fire("overtakeBike:leftSidePressed",!1):"RightSideBtn"===this.entity.name&&this.app.fire("overtakeBike:rightSidePressed",!1)},ButtonHandler.prototype.startTheGame=function(){this.app.fire("overtakeBike:loadHUD"),this.app.fire("overtakeBike:startTheGame")};pc.extend(pc,function(){var t=function(t){this._app=t,this._tweens=[],this._add=[]};t.prototype={add:function(t){return this._add.push(t),t},update:function(t){for(var i=0,e=this._tweens.length;i<e;)this._tweens[i].update(t)?i++:(this._tweens.splice(i,1),e--);this._add.length&&(this._tweens=this._tweens.concat(this._add),this._add.length=0)}};var i=function(t,i,e){pc.events.attach(this),this.manager=i,e&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=t,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.EASE_LINEAR,this._sv={},this._ev={}};i.prototype={to:function(t,i,e,s,n,r){return t instanceof pc.Vec3?this._properties={x:t.x,y:t.y,z:t.z}:t instanceof pc.Color?(this._properties={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(this._properties.a=t.a)):this._properties=t,this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this},from:function(t,i,e,s,n,r){return t instanceof pc.Vec3?this._properties={x:t.x,y:t.y,z:t.z}:t instanceof pc.Color?(this._properties={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(this._properties.a=t.a)):this._properties=t,this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._from=!0,this},rotate:function(t,i,e,s,n,r){return t instanceof pc.Quat?this._properties={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Vec3?this._properties={x:t.x,y:t.y,z:t.z}:t instanceof pc.Color?(this._properties={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(this._properties.a=t.a)):this._properties=t,this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._slerp=!0,this},start:function(){if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(var t in this._properties)this._sv[t]=this._properties[t],this._ev[t]=this.target[t];if(this._slerp){this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z);var i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z;this._fromQuat.setFromEulerAngles(i,e,s)}}else{for(var t in this._properties)this._sv[t]=this.target[t],this._ev[t]=this._properties[t];if(this._slerp){this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z);i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z;this._toQuat.setFromEulerAngles(i,e,s)}}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(t){return this._delay=t,this.pending=!0,this},repeat:function(t,i){return this._count=0,this._numRepeats=t,this._repeatDelay=i||0,this},loop:function(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(t){return this._yoyo=t,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var t=arguments.length;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this},update:function(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time=this.time-this._currentDelay,this.pending=!1}var i=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(i=this.duration-this.time,this.time=0):(i=this.time-this.duration,this.time=this.duration));var e,s,n=this.time/this.duration,r=this.easing(n);for(var h in this._properties)e=this._sv[h],s=this._ev[h],this.target[h]=e+(s-e)*r;if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,r),this.entity&&(this.entity._dirtifyLocal(!0),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){var a=this._repeat(i);return a?this.fire("loop"):(this.fire("complete",i),this._chained&&this._chained.start()),a}return!0},_repeat:function(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var i in this._properties)tmp=this._sv[i],this._sv[i]=this._ev[i],this._ev[i]=tmp;this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var e=function(t){return 1-s(1-t)},s=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375};return{TweenManager:t,Tween:i,Linear:function(t){return t},QuadraticIn:function(t){return t*t},QuadraticOut:function(t){return t*(2-t)},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},CubicIn:function(t){return t*t*t},CubicOut:function(t){return--t*t*t+1},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},QuarticIn:function(t){return t*t*t*t},QuarticOut:function(t){return 1- --t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuinticIn:function(t){return t*t*t*t*t},QuinticOut:function(t){return--t*t*t*t*t+1},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},BackIn:function(t){return t*t*(2.70158*t-1.70158)},BackOut:function(t){return--t*t*(2.70158*t+1.70158)+1},BackInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},BounceIn:e,BounceOut:s,BounceInOut:function(t){return t<.5?.5*e(2*t):.5*s(2*t-1)+.5},ElasticIn:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4))},ElasticOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/.4)+1)},ElasticInOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4)*.5+1)}}}()),function(){var t=pc.Application.getApplication();t&&(t._tweenManager=new pc.TweenManager(t),t.on("update",function(i){t._tweenManager.update(i)}),pc.Application.prototype.tween=function(t){return new pc.Tween(t,this._tweenManager)},pc.Entity.prototype.tween=function(t,i){var e=this._app.tween(t);return e.entity=this,this.on("destroy",function(){e.stop()}),i&&i.element&&(e.element=element),e})}();var ObstacleOvertake=pc.createScript("obstacleOvertake");ObstacleOvertake.prototype.initialize=function(){this.entity.collision.on("collisionstart",this.onTriggerEnter,this)},ObstacleOvertake.prototype.onTriggerEnter=function(e){e.other.name.indexOf("Player")>=0&&e.other.script.has("playerHandler")&&e.other.script.playerHandler.updateScore()};var WallDetection=pc.createScript("wallDetection");WallDetection.attributes.add("bikeSound",{type:"entity",title:"BikeSound"}),WallDetection.attributes.add("bikeCrashSound",{type:"entity",title:"BikeCrashSound"}),WallDetection.prototype.initialize=function(){this.entity.collision.on("collisionstart",this.onCollisionStart,this)},WallDetection.prototype.onCollisionStart=function(t){t.other.name.indexOf("Player")>=0&&(this.app.fire("overtakeBike:saveGameForLocalLB"),this.app.fire("overtakeBike:moveForward"),this.app.fire("overtakeBike:loadGameOver",!0),null!==this.bikeSound&&this.bikeSound.sound.stop("BikeSound"),null!==this.bikeCrashSound&&this.bikeCrashSound.sound.play("CrashSound"),gameOver=!0)};var LocalLeaderBoardHandler=pc.createScript("localLeaderBoardHandler");LocalLeaderBoardHandler.attributes.add("times",{type:"entity",title:"Times"}),LocalLeaderBoardHandler.attributes.add("dates",{type:"entity",title:"Dates"}),LocalLeaderBoardHandler.attributes.add("topScores",{type:"entity",title:"TopScores"}),LocalLeaderBoardHandler.prototype.initialize=function(){this.app.on("overtakeBike:lbWindowState",this.updateUiElementsState,this),this.on("destroy",function(){this.app.off("overtakeBike:lbWindowState",this.updateUiElementsState,this)}),this.setupAttributes()},LocalLeaderBoardHandler.prototype.setupAttributes=function(){this.uiElements=this.entity.children,this.updateUiElementsState(!1),null!==this.times&&null!==this.dates&&null!==this.topScores&&this.times.children.length>0&&this.dates.children.length>0&&this.topScores.children.length>0&&(this.timeElements=this.times.children,this.dateElements=this.dates.children,this.topScoreElements=this.topScores.children)},LocalLeaderBoardHandler.prototype.updateUiElementsState=function(e){if(this.uiElements.length>0)for(var t=0;t<this.uiElements.length;t++)this.uiElements[t].enabled=e;e?this.loadLeaderBoardLocalData():this.resetLeaderBoard()},LocalLeaderBoardHandler.prototype.resetLeaderBoard=function(){this.app.fire("overtakeBike:loadMainMenu")},LocalLeaderBoardHandler.prototype.loadLeaderBoardLocalData=function(){if(this.timeElements.length>0&&this.dateElements.length>0&&this.topScoreElements.length>0){var e=this.getPlayerLocalSaveGameData();if(e.length>0)for(var t=0;t<e.length;t++){var a=e[t].split("*").filter(function(e,t,a){return e.length>0});this.setTextFieldValues(t,a[0],a[1],a[2])}}},LocalLeaderBoardHandler.prototype.getPlayerLocalSaveGameData=function(){var e=[];if(localStorage){var t=localStorage.getItem("overtakeBike-local-player-data");if(null!==t){e=t.split("#").filter(function(e,t,a){return e.length>0})}}return e},LocalLeaderBoardHandler.prototype.setTextFieldValues=function(e,t,a,i){this.topScoreElements[e].element.text=t.toString(),this.timeElements[e].element.text=a.toString(),this.dateElements[e].element.text=i.toString()};